# PMS 기술 구조도 (수정 반영 버전)
## Urban ArchInsight - 교육용 도시 프로젝트 분석 플랫폼

> **설계 원칙**: 실제 프로젝트 진행 순서에 맞춘 페이지 구성, 페이지 단위로 즉시 실행
>
> **수정 일자**: 2025-01-21
>
> **주요 변경사항**:
> - **개인 번호 기반 로그인 시스템** (핵심): 완전한 데이터 격리 및 API 키 영구 저장
> - 페이지 순서 재구성 (실제 작업 흐름 반영)
> - Site Data Collection 제거 → Mapping에 통합
> - 모든 기능에 확인 버튼 추가
> - 페이지 간 데이터 영속성 강화 (개인 번호 기반)
> - 25명 동시 접속 지원 (개인 번호별 격리)

---

## 📋 시스템 개요

### 페이지 구조 (실제 작업 순서)

```
🏠 메인 페이지 (app.py)
    ↓
1️⃣ Block Generator (분석 블록 생성/수정)
    ↓
2️⃣ Mapping (지도 분석 및 데이터 수집)
    ↓
3️⃣ Document Analysis (문서 분석 실행)
    ↓
4️⃣ Prompt Generator (이미지 프롬프트 생성)
    ↓
5️⃣ Video Storyboard Generator (영상 스토리보드 생성) [신규]
```

---

## 🏠 메인 페이지 (app.py)

**목적**: 개인 번호 인증, AI 모델 선택, API 키 관리, 시스템 안내

### 핵심 기능

1. **개인 번호 로그인 시스템 (신규) - 핵심 기능**
   - **로그인 화면**:
     - 개인 번호 입력 필드
     - **🔐 로그인 버튼**: 번호 검증 및 입장
     - 로그인 전에는 다른 페이지 접근 불가
   - **번호 검증**:
     - 관리자가 미리 등록한 번호 목록과 대조
     - 등록되지 않은 번호는 접근 거부
     - 에러 메시지 표시
   - **자동 데이터 로드**:
     - 로그인 성공 시 개인 번호에 연결된 데이터 자동 로드:
       - API 키 (자동 입력)
       - 저장된 블록 목록
       - 이전 프로젝트 세션
       - 개인 설정 (선호 모델, 파라미터 등)
   - **로그아웃**:
     - 🚪 **로그아웃 버튼** (우측 상단)
     - 세션 데이터 자동 저장 후 로그인 화면으로 복귀

2. **AI 모델 선택 및 관리**
   - 지원 모델: Gemini 2.5 Pro, OpenAI GPT-4, Vertex AI
   - 드롭다운으로 모델 선택
   - 모델별 파라미터 표시
   - **개인별 선호 모델 저장**: 로그인 시 자동 선택

3. **API 키 관리 (개선 + 개인별 저장)**
   - **자동 로드**: 로그인 시 저장된 API 키 자동 입력
   - API 키 입력 필드 (비밀번호 형식)
   - ✅ **확인 버튼**: 키 저장 및 검증
     - 개인 번호에 연결하여 서버/DB에 영구 저장
     - 다음 로그인 시 자동 로드
   - 🗑️ **삭제 버튼**: 키 제거 (서버에서도 삭제)
   - 키 상태 표시 (설정됨/미설정, 출처 표시)
   - 키 길이 및 유효성 확인
   - **보안**: API 키는 암호화되어 저장

4. **시스템 상태 대시보드**
   - 필수 모듈 설치 상태
   - API 키 설정 상태
   - 현재 로그인한 개인 번호 표시
   - 동시 접속자 수 표시 (최대 25명)
   - 시스템 리소스 사용률 (메모리, CPU)

5. **빠른 시작 가이드**
   - 단계별 튜토리얼
   - 각 페이지 기능 소개
   - 샘플 프로젝트 로드 버튼

6. **세션 관리 (개인 번호 기반)**
   - 개인 번호 + 세션 ID 자동 생성
   - 개인별 데이터 완전 격리
   - 세션 저장/불러오기 기능
   - 세션 만료 시간 설정 (기본 4시간)
   - 자동 저장: 개인 번호에 연결하여 영구 저장

7. **에러 처리 및 복구**
   - 자동 오류 감지
   - 오류 복구 안내
   - 로그 다운로드 기능

---

## 1️⃣ Block Generator (분석 블록 생성기)

**목적**: 커스텀 분석 블록 생성, 수정, 관리

### 페이지 레이아웃

```
[사이드바]                    [메인 컨텐츠]
- 기존 블록 목록               - 블록 정보 입력 폼
- 카테고리별 필터              - RISEN 프롬프트 구조
- 내 블록 / 공용 블록          - 미리보기
- 검색                        - 생성/수정/삭제 버튼
```

### 핵심 기능

#### 1. **기본 정보 입력 (개선)**
   - 블록 이름 (text_input)
   - 블록 설명 (text_area)
   - 카테고리 선택 (selectbox)
     - 기본 정보 & 요구사항
     - 입지 분석
     - 프로그램 계획
     - 공간 계획
     - 비즈니스 모델 [신규]
     - 기타 (새 카테고리 추가)
   - **블록 ID 자동 생성 (개인 번호 기반)**:
     - 자동 생성: `{개인번호}_{카테고리}_{번호}`
     - 예시: `USER001_입지분석_001`
     - 개인 번호가 블록 소유권을 명확히 식별
   - 공개 범위 선택: 개인용 / 팀 공유 / 전체 공개
     - **기본값: 개인용** (다른 사용자는 볼 수 없음)
     - 팀 공유: 같은 팀 멤버만 조회 가능
     - 전체 공개: 모든 사용자가 조회 가능

#### 2. **RISEN 프롬프트 구조 (개선)**
   - **역할 (Role)**: AI 전문가 역할 정의
   - **지시 (Instructions)**: 구체적 작업 지시
   - **단계 (Steps)**:
     - 단계 개수 선택 (1~10)
     - **✅ 확인 버튼**: 단계 개수 확정 후 입력 필드 생성
     - 각 단계별 상세 내용 입력
   - **최종 목표 (End Goal)**: 달성 결과
   - **구체화/제약 조건 (Narrowing)**:
     - 출력 형식, 필수 항목, 제약 조건
     - 품질 기준, 평가 기준, 점수 체계

#### 3. **블록 생성 및 관리 (개선)**
   - **📝 블록 생성**: 새 블록 생성 및 저장
   - **💾 블록 저장**: 수정 내용 저장
   - **👁️ 블록 상세 보기**: 선택한 블록의 전체 정보 표시
   - **✏️ 블록 수정**: 기존 블록 편집
   - **🗑️ 블록 삭제**: 블록 제거 (확인 다이얼로그)
   - **📋 블록 복제**: 기존 블록 복사 후 수정
   - **⬇️ 블록 내보내기**: JSON 파일로 다운로드
   - **⬆️ 블록 가져오기**: JSON 파일에서 블록 로드

#### 4. **카테고리별 템플릿 블록 (신규)**
   - 각 카테고리당 1개의 템플릿 블록 제공
   - **기본 정보 & 요구사항**: "요구사항 파싱 템플릿"
   - **입지 분석**: "후보지 평가 템플릿"
   - **프로그램 계획**: "프로그램 구성 템플릿"
   - **공간 계획**: "공간 배치 템플릿"
   - **비즈니스 모델**: "비즈니스 모델 캔버스 템플릿"
   - 템플릿 기반 빠른 생성 가능

#### 5. **블록 관리 시스템 (개인 번호 기반 격리 강화)**
   - **내 블록**: 로그인한 개인 번호로 생성한 블록만 표시
     - 다른 사용자의 개인용 블록은 완전히 숨김
     - 블록 ID가 현재 개인 번호로 시작하는 것만 필터링
   - **팀 블록**: 팀원이 "팀 공유"로 설정한 블록
     - 같은 팀 ID를 가진 사용자들만 조회 가능
   - **공용 블록**: "전체 공개"로 설정된 블록 (모든 사용자 조회 가능)
   - **즐겨찾기**: 개인별 즐겨찾기 (개인 번호에 연결)
   - **최근 사용**: 개인별 사용 히스토리 (개인 번호에 연결)

#### 6. **블록 검색 및 필터링 (신규)**
   - 이름, 설명, 카테고리로 검색
   - 카테고리별 필터
   - 공개 범위별 필터
   - 최근 생성순/이름순 정렬

#### 7. **블록 미리보기 (신규)**
   - 실시간 프롬프트 미리보기
   - 예상 출력 형식 표시
   - DSPy Signature 코드 미리보기
   - JSON 구조 미리보기

#### 8. **블록 검증 (신규)**
   - 필수 필드 체크
   - 프롬프트 품질 점수
   - 중복 블록 확인
   - 저장 전 검증 실행

#### 9. **DSL 구조 설명 (신규)**
   - **블록 저장 구조 설명**:
     ```json
     {
       "block_id": "user001_location_001",
       "name": "후보지 평가",
       "category": "입지 분석",
       "owner": "USER001",  // 개인 번호 (로그인 시 입력한 번호)
       "visibility": "private",  // private: 소유자만, team: 같은 팀, public: 모두
       "team_id": "TEAM_01",  // 팀 공유 시 필요
       "role": "...",
       "instructions": "...",
       "steps": [...],
       "end_goal": "...",
       "narrowing": {...}
     }
     ```
   - **블록 접근 권한 검증**:
     - 블록 로드 시 현재 로그인한 개인 번호와 owner 비교
     - visibility가 "private"이면 owner만 접근 가능
     - visibility가 "team"이면 같은 team_id를 가진 사용자만 접근
     - visibility가 "public"이면 모든 사용자 접근 가능
   - **분석 과정 설명**:
     1. 블록 로드 → DSPy Signature 생성
     2. AI 모델에 프롬프트 전달
     3. Chain-of-Thought 실행
     4. 결과 구조화 및 저장
   - **예시 블록 3개 제공**:
     - 기본 정보 추출 블록
     - 입지 분석 블록
     - 비즈니스 모델 블록

---

## 2️⃣ Mapping (지도 분석 및 데이터 수집)

**목적**: 공간 정보 시각화, 도시 데이터 수집, 분석 블록 연동

### 페이지 레이아웃

```
[탭 1: 연속 지적도]
[탭 2: 데이터 수집] [신규 - Site Data Collection 통합]
[탭 3: 입지 후보지 시각화]
```

### 탭 1: 연속 지적도 (기존 유지 + 개선)

#### 핵심 기능

1. **지도 위치 설정**
   - 위도/경도 입력
   - **✅ 확인 버튼**: 위치 이동 실행
   - 줌 레벨 선택 (5~19)
   - 주요 도시 선택 드롭다운
   - **📍 선택 도시로 이동 버튼**

2. **VWorld 레이어 선택 (확대)**
   - **연속 지적도**:
     - 본번 레이어
     - 부번 레이어
   - **용도지역** (8개 → 15개로 확대):
     - 도시지역, 관리지역, 농림지역, 자연환경보전지역
     - 경관지구, 미관지구, 고도지구 [신규]
     - 방재지구, 방화지구, 보존지구 [신규]
     - 시설보호지구, 취락지구 [신규]
     - 개발진흥지구, 특정용도제한지구 [신규]
     - 개발제한구역, 국토계획구역 [신규]
   - **도시계획시설** (7개 → 12개로 확대):
     - 도로, 교통시설, 공간시설, 공공문화체육시설
     - 방재시설, 환경기초시설, 지구단위계획
     - 학교시설 [신규]
     - 의료시설 [신규]
     - 유통공급시설 [신규]
     - 보건위생시설 [신규]
     - 문화시설 [신규]
   - **토지이용계획** [신규]:
     - 토지이용계획 확인서 레이어
     - 개발행위허가제한 레이어
   - 레이어 투명도 조절 슬라이더

3. **지적 정보 조회**
   - 지도 클릭 → 위치 자동 저장
   - **🔍 이 위치의 지적 정보 조회 버튼**
   - GetFeatureInfo 실행
   - 조회 결과 표시:
     - 필지 정보 (PNU, 지번, 지목, 면적)
     - 공시지가, 소유 구분
     - 주소 정보
   - **💾 정보 저장 버튼**: session_state에 저장

4. **WFS 고급 조회 (개선)**
   - BBOX 영역 설정
   - 조회 레이어 선택
   - 최대 피처 수 설정
   - **🔍 WFS 데이터 조회 버튼**
   - 결과 테이블 표시
   - **⬇️ GeoJSON 다운로드 버튼**
   - **💾 데이터 저장 버튼**: session_state에 저장

### 탭 2: 데이터 수집 [신규 - Site Data Collection 통합]

#### 핵심 기능

1. **좌표 및 반경 설정 (개선)**
   - 위도/경도 입력
   - **반경 설정**: 100m ~ 5000m (슬라이더)
   - 사이트 이름 입력
   - **반경 원 미리보기**: 지도에 표시
   - **✅ 확인 버튼**: 설정 확정

2. **수집 데이터 선택 (확대)**
   - **OSM POI 데이터** (체크박스):
     - 병원, 학교, 상점, 교통시설
     - 문화시설, 체육시설 [신규]
     - 공원, 녹지 [신규]
   - **VWorld 용도지역 데이터** (체크박스) [신규]
   - **KOSIS 통계 데이터** (체크박스) [신규]:
     - 인구, 가구, 연령대별 분포
     - 소득 수준, 주거 형태
   - **공공시설 데이터** (체크박스) [신규]:
     - 공공데이터포털 API 연동
     - 복지시설, 공공기관 등
   - **교통 데이터** (체크박스) [신규]:
     - 버스 정류장, 지하철역
     - 주차장, 도로 정보

3. **데이터 수집 실행 (개선)**
   - **🚀 데이터 수집 시작 버튼**
   - 진행 상황 표시 (Progress bar)
   - 수집 상태 메시지
   - 에러 처리 및 재시도
   - 수집 완료 알림

4. **수집 결과 시각화 (확대)**
   - **요약 테이블**:
     - 수집된 데이터 개수 (POI, 통계 등)
     - 반경 내 주요 시설 개수
     - 용도지역 분포
   - **POI 지도 표시**:
     - 타입별 색상 구분 마커
     - 팝업으로 상세 정보
     - 범례 표시
   - **통계 차트** [신규]:
     - POI 타입별 막대 차트
     - 인구 통계 차트 (연령대별)
     - 용도지역 파이 차트
   - **거리 분석** [신규]:
     - 시설까지의 거리 분포
     - 접근성 점수 계산
     - 히트맵 표시

5. **데이터 테이블 (개선)**
   - 수집된 데이터 테이블 표시
   - 필터링 및 정렬 기능
   - 페이지네이션 (최대 500행)
   - **⬇️ Excel 다운로드 버튼**
   - **⬇️ CSV 다운로드 버튼**
   - **⬇️ GeoJSON 다운로드 버튼**

6. **분석 블록 연동 (신규) - 핵심 기능**

   **대안 1: 데이터를 참고 문서로 활용**
   - **💾 데이터 저장 버튼**:
     - 수집된 데이터를 구조화된 텍스트로 변환
     - session_state.mapping_data에 저장
     - 저장 완료 메시지 표시
   - **Document Analysis 페이지 연동**:
     - "Mapping 데이터 불러오기" 버튼 추가
     - 저장된 데이터를 참고 문서로 로드
     - 분석 시 자동 참조

   **대안 2: 블록 직접 연동 (고급 기능)**
   - **🔗 블록 연동 섹션** (Expander):
     - "이 데이터로 분석할 블록 선택" 드롭다운
     - 입지 분석 관련 블록 자동 필터링
     - 체크박스로 다중 선택
     - **▶️ 선택한 블록 즉시 실행 버튼**
   - **즉시 분석 실행**:
     - 수집된 데이터를 블록 입력으로 자동 전달
     - 백그라운드 분석 실행
     - 결과를 session_state에 저장
     - "Document Analysis에서 결과 확인" 링크 표시
   - **에러 처리**:
     - 데이터 형식 검증
     - 블록 실행 실패 시 오류 메시지
     - 재시도 옵션 제공

7. **지오딕트 기능 참고 (신규)**
   - **버퍼 분석**: 반경 내 데이터 필터링
   - **거리 계산**: 시설까지의 직선 거리
   - **접근성 분석**: 도보/차량 접근 시간 계산
   - **밀도 분석**: 인구/시설 밀도 히트맵
   - **비교 분석**: 여러 후보지 비교 테이블

### 탭 3: 입지 후보지 시각화 (개선)

#### 핵심 기능

1. **후보지 데이터 로드**
   - Document Analysis에서 Felo 데이터 로드
   - 후보지 목록 표시
   - 후보지별 정보 요약

2. **후보지 지도 표시**
   - 모든 후보지 마커 표시
   - 후보지별 색상 구분
   - 팝업으로 상세 정보
   - 선택한 후보지 하이라이트

3. **후보지 비교 분석 (신규)**
   - 후보지 선택 (다중 선택)
   - 비교 테이블 생성
   - 평가 항목별 점수 표시
   - 레이더 차트로 시각화
   - **⬇️ 비교 분석 결과 다운로드 버튼**

4. **후보지 상세 분석 (신규)**
   - 선택한 후보지 상세 페이지
   - 주변 POI 표시
   - 용도지역 정보
   - 접근성 분석
   - SWOT 분석 표시

---

## 3️⃣ Document Analysis (문서 분석)

**목적**: 프로젝트 문서 분석 및 AI 기반 다단계 분석 실행

### 페이지 레이아웃

```
[탭 1: 프로젝트 정보]
[탭 2: 파일 업로드]
[탭 3: 분석 블록 선택]
[탭 4: 분석 실행]
[탭 5: 결과 조회]
```

### 핵심 기능

#### 1. **프로젝트 기본 정보 입력 (개선)**
   - 프로젝트명 입력
   - 위치 입력
   - 위도/경도 입력
   - 프로젝트 목표 (text_area)
   - 추가 정보 (text_area)
   - **Mapping 데이터 불러오기 버튼** [신규]:
     - session_state.mapping_data 로드
     - "반경 데이터" 섹션에 자동 입력
     - 데이터 미리보기 표시
   - **✅ 정보 저장 버튼**: session_state에 저장

#### 2. **파일 업로드 (개선)**
   - 파일 업로드 (PDF, DOCX, XLSX, CSV)
   - **✅ 파일 분석 버튼**: 텍스트 추출 실행
   - 파일 정보 표시 (크기, 페이지 수, 단어 수)
   - 파일 미리보기 (최대 500자)
   - **참고 URL 추가**:
     - URL 입력 필드
     - **➕ URL 추가 버튼**
     - URL 목록 표시
     - **🗑️ 개별 URL 삭제 버튼**
   - **✅ 모든 파일 확인 버튼**: 최종 확인

#### 3. **분석 블록 선택 (개선)**
   - **블록 카테고리 필터**: 전체/입지/프로그램/공간/비즈니스
   - **내 블록 / 공용 블록 필터**
   - 블록 목록 (체크박스):
     - 블록 이름, 설명, 카테고리 표시
     - 블록 상세 보기 (Expander)
   - **블록 순서 조정**:
     - ⬆️ 위로 버튼
     - ⬇️ 아래로 버튼
   - **선택한 블록 요약**: 개수 및 순서 표시
   - **✅ 블록 선택 확정 버튼**

#### 4. **분석 실행 (개선) - 핵심 기능**

   **분석 전 설정**:
   - LLM 파라미터 설정:
     - Temperature (0.0 ~ 1.0)
     - Max Tokens (1000 ~ 32000)
   - **Chain-of-Thought 옵션**:
     - 단계별 사고 과정 표시
     - 중간 결과 저장
   - **✅ 설정 확인 버튼**

   **분석 세션 준비**:
   - **🚀 분석 시작 버튼**
   - 선택한 블록 순서 확인
   - 예상 소요 시간 표시
   - 확인 다이얼로그

   **분석 진행 중 제어 (신규)**:
   - **진행 상황 표시**:
     - 전체 진행률 (Progress bar)
     - 현재 실행 중인 블록 표시
     - 완료된 블록 / 전체 블록
   - **⏸️ 일시 정지 버튼** [신규]:
     - 분석 일시 중지
     - 현재까지의 결과 저장
     - 재개 가능
   - **⏭️ 블록 건너뛰기 버튼** [신규]:
     - 현재 블록 건너뛰기
     - 다음 블록으로 이동
     - 건너뛴 블록 표시
   - **➕ 블록 추가 버튼** [신규]:
     - 분석 중 블록 추가 가능
     - 추가 위치 선택 (현재 이후 / 마지막)
     - 블록 선택 모달
   - **🗑️ 블록 제거 버튼** [신규]:
     - 대기 중인 블록 제거
     - 이미 실행된 블록은 제거 불가
   - **⏹️ 분석 중지 버튼**:
     - 분석 완전 중지
     - 현재까지 결과 저장
     - 세션 유지

   **분석 결과 실시간 표시**:
   - 각 블록 완료 시 즉시 결과 표시
   - 단계별 요약 표시
   - CoT 사고 과정 표시

#### 5. **결과 조회 (개선)**
   - **탭 형식 결과 표시**:
     - 각 블록별 결과 탭
     - 전체 결과 종합 탭
   - **블록별 상세 결과**:
     - 분석 텍스트
     - CoT 단계별 사고 과정
     - 인용 및 출처
     - 신뢰도 점수 (선택 사항)
   - **피드백 기반 재검토 (개선)** [신규]:
     - 각 블록 결과 하단에 피드백 입력란
     - **💬 피드백 입력 버튼**: 입력란 표시/숨김
     - 피드백 작성 (text_area)
     - **🔄 재분석 요청 버튼**: 피드백 반영하여 재실행
     - 재분석 결과 비교 표시 (이전 vs 새로운 결과)
     - **✅ 결과 확정 버튼**: 최종 결과 선택
   - **결과 관리**:
     - 💾 개별 블록 결과 저장
     - 📋 결과 복사
     - 🔗 결과 공유 링크 생성

#### 6. **결과 다운로드 (개선)**
   - **Word 문서 생성**:
     - 프로젝트 정보 포함
     - 각 블록 결과 섹션별 구성
     - 차트 및 표 포함
     - **⬇️ Word 다운로드 버튼**
   - **Excel 데이터 시트** [신규]:
     - 블록별 결과를 시트로 구성
     - 구조화된 데이터 정리
     - **⬇️ Excel 다운로드 버튼**
   - **PDF 보고서** [신규]:
     - 고품질 PDF 생성
     - 템플릿 선택 가능
     - **⬇️ PDF 다운로드 버튼**
   - **JSON 데이터** [신규]:
     - 전체 분석 결과 JSON
     - API 연동 가능
     - **⬇️ JSON 다운로드 버튼**

#### 7. **세션 관리 (개선)**
   - **💾 분석 세션 저장**:
     - 세션 이름 입력
     - 전체 상태 저장
     - 저장 위치 선택 (로컬 / 서버)
   - **📂 저장된 세션 불러오기**:
     - 세션 목록 표시
     - 세션 정보 미리보기
     - **불러오기 버튼**
   - **🔄 분석 세션 초기화**:
     - 확인 다이얼로그
     - 모든 입력값 및 결과 리셋
   - **[DEBUG] 세션 상태 확인**: 개발자 모드

#### 8. **데이터 영속성 보장 (신규)**
   - **자동 저장**:
     - 5분마다 자동 저장
     - 페이지 이동 시 자동 저장
     - 저장 상태 표시 (마지막 저장 시간)
   - **복구 기능**:
     - 비정상 종료 시 복구
     - "이전 세션 복구" 버튼
     - 복구 가능한 세션 목록

---

## 4️⃣ Prompt Generator (이미지 프롬프트 생성기)

**목적**: 건축 프로젝트 분석 결과를 기반으로 AI 이미지 생성 프롬프트 생성

### 페이지 레이아웃

```
[사이드바]                     [메인 컨텐츠]
- 데이터 소스 선택              - 데이터 미리보기
- 이미지 설정                  - 프롬프트 생성 결과
- 플랫폼 선택 [신규]            - 건축 스타일 옵션 [신규]
```

### 핵심 기능

#### 1. **데이터 소스 선택 (기존 유지)**
   - 라디오 버튼:
     - PDF 파일 업로드
     - Document Analysis 결과 활용
     - 직접 입력
   - **✅ 데이터 소스 확인 버튼**

#### 2. **PDF 파일 업로드 (개선)**
   - PDF 파일 업로드
   - **✅ PDF 분석 버튼**: 텍스트 추출
   - 분석 완료 메시지
   - PDF 내용 미리보기

#### 3. **Document Analysis 결과 활용 (기존 유지)**
   - session_state에서 자동 로드
   - 프로젝트 정보 표시
   - CoT 히스토리 표시

#### 4. **직접 입력 (개선)**
   - 프로젝트명, 건물 유형, 위치, 건축주, 면적
   - **✅ 정보 확인 버튼**

#### 5. **이미지 플랫폼 선택 (신규) - 핵심 기능**
   - **플랫폼 선택 (라디오 버튼)**:
     - 🎨 Midjourney
     - 🍌 나노바나나
     - 🎬 기타 (Stable Diffusion, DALL-E 등)
   - 플랫폼별 최적화된 프롬프트 생성

#### 6. **이미지 설정 (확대)**
   - **이미지 유형** (selectbox):
     - 외관 렌더링
     - 내부 공간
     - 마스터플랜
     - 조감도
     - 상세도
     - 컨셉 이미지
     - 다이어그램 [신규]
   - **스타일 선호도** (multiselect):
     - 현대적, 미니멀, 자연친화적
     - 고급스러운, 기능적, 예술적, 상업적
   - **건축 스타일 (신규) - 핵심 기능**:
     - **건축가 스타일** (selectbox):
       - Le Corbusier (르 코르뷔지에)
       - Frank Lloyd Wright (프랭크 로이드 라이트)
       - Zaha Hadid (자하 하디드)
       - Tadao Ando (안도 타다오)
       - Norman Foster (노먼 포스터)
       - Renzo Piano (렌조 피아노)
       - Herzog & de Meuron (헤르조그 & 드 뫼롱)
       - MVRDV
       - Bjarke Ingels (비야케 잉겔스)
       - 기타 / 직접 입력
     - **설계 회사 스타일** (selectbox):
       - Gensler
       - HOK
       - Perkins&Will
       - SOM (Skidmore, Owings & Merrill)
       - Foster + Partners
       - OMA (Office for Metropolitan Architecture)
       - 현대건축
       - 삼우종합건축
       - 정림건축
       - 기타 / 직접 입력
   - **추가 설명** (text_area)
   - **✅ 설정 확인 버튼**

#### 7. **프롬프트 생성 (개선)**
   - **🎨 Midjourney 프롬프트 생성 버튼** (플랫폼에 따라 레이블 변경)
   - 입력 데이터 검증
   - AI 프롬프트 생성:
     - 프로젝트 정보 + 분석 결과 + 이미지 설정 통합
     - 건축가 스타일 키워드 자동 적용
     - 설계 회사 특징 반영
     - 플랫폼별 최적화된 프롬프트 구조
   - 로딩 표시

#### 8. **생성 결과 표시 (개선)**
   - **한글 설명**:
     - 건축적 특징, 분위기, 핵심 요소
   - **영어 프롬프트**:
     - Midjourney: 기존 형식 유지
     - 나노바나나: 최적화된 형식
     - 기타: 범용 형식
   - **📋 프롬프트 복사 버튼**
   - **플랫폼별 팁 표시** [신규]:
     - Midjourney: 파라미터 사용법 (--ar, --v, --style 등)
     - 나노바나나: 최적 설정 안내
   - **전체 분석 결과** (Expander)
   - **생성 모델 정보** (caption)

#### 9. **프롬프트 라이브러리 (신규)**
   - **💾 프롬프트 저장**:
     - 프롬프트 이름 입력
     - 태그 추가
     - 저장 버튼
   - **📚 저장된 프롬프트 목록**:
     - 프롬프트 검색
     - 태그 필터링
     - 프롬프트 불러오기
     - 프롬프트 수정/삭제

#### 10. **배치 프롬프트 생성 (신규)**
   - 여러 스타일/건축가 조합 선택
   - 한 번에 다중 프롬프트 생성
   - 프롬프트 비교 테이블
   - **⬇️ 전체 프롬프트 다운로드 버튼** (Excel/JSON)

---

## 5️⃣ Video Storyboard Generator (영상 스토리보드 생성기) [신규 페이지]

**목적**: 건축 프로젝트 영상용 스토리보드 및 Narrative 생성

### 페이지 레이아웃

```
[사이드바]                     [메인 컨텐츠]
- 데이터 소스 선택              - 스토리보드 미리보기
- 영상 설정                    - Scene 편집
- Narrative 옵션               - 타임라인
```

### 핵심 기능

#### 1. **데이터 소스 선택**
   - Document Analysis 결과 활용
   - 직접 입력 (프로젝트 정보)
   - **✅ 데이터 확인 버튼**

#### 2. **영상 설정**
   - **영상 유형** (selectbox):
     - 프로젝트 소개 영상
     - 공간 워크스루
     - 컨셉 설명 영상
     - 타임랩스 영상
     - 드론 촬영 영상
   - **영상 길이**: 30초 / 1분 / 2분 / 3분 / 5분
   - **타겟 관객**: 일반인 / 전문가 / 클라이언트 / 학생
   - **분위기**: 역동적 / 차분한 / 감성적 / 전문적

#### 3. **Scene 구성**
   - **Scene 개수 선택**: 3~20개
   - **✅ Scene 개수 확인 버튼**: Scene 입력 필드 생성
   - 각 Scene별 입력:
     - Scene 이름
     - 장면 설명 (text_area)
     - 촬영 각도 (selectbox): 정면 / 측면 / 조감 / 클로즈업 / 와이드
     - 카메라 움직임: 고정 / 팬 / 틸트 / 줌 / 트래킹
     - 예상 시간 (초)
   - **Scene 순서 조정**:
     - ⬆️ 위로, ⬇️ 아래로 버튼
   - **➕ Scene 추가**, **🗑️ Scene 삭제**

#### 4. **Narrative 생성**
   - **Narrative 타입** (selectbox):
     - 스토리텔링형
     - 설명형
     - 감성형
     - 기술 중심형
   - **Narrative 톤**: 공식적 / 친근한 / 열정적 / 차분한
   - **🎬 Narrative 생성 버튼**:
     - AI가 각 Scene에 맞는 Narrative 자동 생성
     - 전체 흐름 고려
   - Narrative 결과 표시 (각 Scene별)
   - **✏️ Narrative 수정**: 인라인 편집 가능

#### 5. **스토리보드 미리보기**
   - **타임라인 뷰**:
     - Scene 순서대로 표시
     - 각 Scene 썸네일 (텍스트)
     - Scene 시간 표시
     - 누적 시간 표시
   - **테이블 뷰**:
     - Scene 번호, 이름, 설명
     - 촬영 각도, 카메라 움직임
     - Narrative
     - 시간
   - **플레이 시뮬레이션** [고급 기능]:
     - ▶️ 재생 버튼
     - Scene 자동 전환
     - Narrative 읽기

#### 6. **프롬프트 생성**
   - **각 Scene별 이미지 프롬프트 자동 생성**:
     - Scene 설명 + 촬영 각도 → Midjourney 프롬프트
     - 생성된 프롬프트 표시
   - **📋 전체 프롬프트 복사**
   - **⬇️ 프롬프트 다운로드** (텍스트 파일)

#### 7. **스토리보드 다운로드**
   - **⬇️ Word 문서 다운로드**:
     - 표 형식 스토리보드
     - Scene별 이미지 삽입 공간
     - Narrative 포함
   - **⬇️ PDF 다운로드**:
     - 전문가용 스토리보드
     - 타임라인 포함
   - **⬇️ Excel 다운로드**:
     - Scene 데이터 시트
     - 편집 가능

#### 8. **템플릿 라이브러리**
   - 미리 정의된 스토리보드 템플릿:
     - 주거 프로젝트 템플릿
     - 상업 프로젝트 템플릿
     - 문화시설 템플릿
     - 교육시설 템플릿
   - 템플릿 선택 후 커스터마이징

---

## 🔗 페이지 간 데이터 연동 (개선)

### Session State 구조 (개인 번호 기반으로 확대)

```python
# 로그인 및 인증 정보 [신규]
st.session_state.is_logged_in = False  # 로그인 여부
st.session_state.user_number = None  # 개인 번호 (예: "USER001", "STU12345" 등)
st.session_state.user_name = None  # 사용자 이름 (선택 사항)
st.session_state.team_id = None  # 팀 ID (선택 사항)

# 사용자 정보
st.session_state.user_id = "USER001"  # user_number와 동일
st.session_state.session_id = "SESSION_20250120_001"  # user_number + 타임스탬프

# 프로젝트 기본 정보
st.session_state.project_name
st.session_state.location
st.session_state.latitude
st.session_state.longitude
st.session_state.project_goals
st.session_state.additional_info

# 파일 및 텍스트
st.session_state.uploaded_files = []
st.session_state.pdf_text
st.session_state.reference_documents

# AI 분석 관련
st.session_state.llm_provider
st.session_state.llm_temperature
st.session_state.llm_max_tokens
st.session_state.selected_blocks = []
st.session_state.analysis_results = {}

# Chain of Thought
st.session_state.cot_session
st.session_state.cot_results = {}
st.session_state.cot_history = []
st.session_state.cot_status = "idle"  # idle / running / paused / completed

# Mapping 데이터 [신규]
st.session_state.mapping_data = {
    "site_location": {"lat": 0, "lon": 0, "radius": 1000},
    "osm_poi": [],
    "vworld_zoning": [],
    "kosis_stats": {},
    "cadastral_info": {}
}
st.session_state.collected_data_timestamp

# Block Generator [신규]
st.session_state.user_blocks = []
st.session_state.team_blocks = []
st.session_state.favorite_blocks = []

# Prompt Generator [신규]
st.session_state.generated_prompts = []
st.session_state.prompt_library = []

# Video Storyboard [신규]
st.session_state.storyboard_scenes = []
st.session_state.narratives = []

# 세션 관리
st.session_state.last_saved_time
st.session_state.auto_save_enabled = True
st.session_state.session_dirty = False  # 변경사항 있음
```

### 데이터 흐름 다이어그램 (개인 번호 기반)

```
로그인 페이지
    → 개인 번호 입력 및 검증
    → 개인 번호에 연결된 데이터 로드:
       - API 키 (자동 입력)
       - 사용자 설정
       - 블록 목록
    ↓
Block Generator
    → 새 블록 생성 (owner = 개인 번호)
    → user:{개인번호}:blocks에 저장
    → visibility에 따라 접근 권한 설정
    ↓
Document Analysis
    ← user:{개인번호}:blocks 로드 (권한 필터링)
    ← Mapping 데이터 로드 (user:{개인번호}:mapping_data)
    → 분석 실행
    → user:{개인번호}:cot_results, analysis_results 저장
    ↓
Prompt Generator
    ← user:{개인번호}:analysis_results, cot_history 로드
    → 프롬프트 생성
    → user:{개인번호}:generated_prompts 저장
    ↓
Video Storyboard Generator [신규]
    ← user:{개인번호}:analysis_results, generated_prompts 로드
    → 스토리보드 생성
    → user:{개인번호}:storyboard_scenes, narratives 저장

Mapping
    → 데이터 수집
    → user:{개인번호}:mapping_data 저장
    → Document Analysis로 전달

로그아웃
    → 현재 세션 데이터 자동 저장
    → user:{개인번호}:session_backup에 백업
    → 로그인 페이지로 복귀
```

### 자동 저장 메커니즘 (신규)

```python
# 5분마다 자동 저장
if time.time() - st.session_state.last_saved_time > 300:
    save_session_to_server()
    st.session_state.last_saved_time = time.time()

# 페이지 이동 시 자동 저장
@st.cache_data
def on_page_change():
    if st.session_state.session_dirty:
        save_session_to_server()
        st.session_state.session_dirty = False

# 변경사항 추적
def mark_dirty():
    st.session_state.session_dirty = True
```

---

## 📊 동시 접속 지원 (25명)

### 시스템 요구사항

**하드웨어**:
- CPU: 8 Core 이상
- RAM: 16GB 이상
- 저장공간: 100GB 이상

**소프트웨어**:
- Streamlit 1.39.0+
- Redis (세션 관리)
- PostgreSQL (데이터 저장)

### 세션 격리 전략 (개인 번호 기반)

1. **개인 번호 기반 인증 및 세션 생성**:
   - 관리자가 미리 등록한 개인 번호 목록 관리 (DB 또는 파일)
   - 로그인 시 개인 번호 검증
   - 세션 ID 형식: `{개인번호}_{날짜}_{순번}`
   - 예시: `USER001_20250120_001`

2. **완전한 데이터 격리**:
   - 모든 데이터는 개인 번호를 네임스페이스로 사용
   - **Redis 키 형식**: `user:{user_number}:{key}`
     - 예시: `user:USER001:blocks`, `user:USER001:api_key`
   - **PostgreSQL 테이블**: `user_number` 컬럼으로 필터링
     - 모든 쿼리에 `WHERE user_number = ?` 조건 필수
   - **파일 시스템**: `data/{user_number}/` 디렉토리 분리
   - 다른 사용자의 데이터는 절대 조회 불가 (권한 검증)

3. **API 키 영구 저장**:
   - API 키는 개인 번호에 연결하여 암호화 저장
   - 저장 위치: `user:{user_number}:api_keys`
   - 로그인 시 자동 로드 및 복호화
   - 로그아웃 시에도 서버에 유지 (다음 로그인 시 재사용)

4. **블록 및 프로젝트 격리**:
   - 블록 ID: `{user_number}_{category}_{번호}`
   - 공개 범위에 따라 조회 권한 관리:
     - `private`: 소유자만 조회
     - `team`: 같은 team_id를 가진 사용자 조회 가능
     - `public`: 모든 사용자 조회 가능
   - 프로젝트 데이터도 동일한 권한 체계 적용

5. **리소스 제한**:
   - 사용자당 최대 메모리: 512MB
   - 동시 AI 요청: 최대 3개 (대기열 관리)
   - 세션 타임아웃: 4시간
   - 개인당 블록 개수 제한: 100개 (설정 가능)
   - 개인당 저장 공간: 1GB

6. **성능 최적화**:
   - 페이지네이션 (최대 500행)
   - 이미지/지도 레이지 로딩
   - 결과 캐싱 (개인별 캐시)
   - 백그라운드 작업 큐

### 모니터링

- 실시간 접속자 수 표시 (개인 번호별)
- 로그인 이력 (개인 번호, 시간, IP)
- 서버 리소스 사용률 (전체 및 개인별)
- 에러 로그 (개인 번호 연결)
- 세션 활동 로그 (개인별 작업 히스토리)
- API 키 사용 현황 (개인별)

### 관리자 기능 (신규)

- **개인 번호 관리**:
  - 새 개인 번호 생성 및 등록
  - 개인 번호 비활성화/삭제
  - 번호 목록 및 상태 조회
  - 번호별 리소스 사용 현황 조회
- **팀 관리**:
  - 팀 생성 및 멤버 할당
  - 개인 번호를 팀에 추가/제거
- **데이터 관리**:
  - 개인별 데이터 백업/복구
  - 데이터 용량 모니터링 및 제한 설정

---

## 🎯 주요 개선사항 요약

### 0. 개인 번호 기반 시스템 (핵심 변경)
✅ **로그인 시스템**: 개인 번호 입력 후 접근 가능
✅ **완전한 데이터 격리**: 모든 데이터가 개인 번호로 분리
✅ **API 키 영구 저장**: 개인 번호에 연결하여 자동 로드
✅ **블록 개인 소유**: 각자 만든 블록은 각자만 볼 수 있음 (기본)
✅ **선택적 공유**: 원하는 경우 팀 또는 전체 공개 가능

### 1. 공통 개선
✅ 모든 기능에 확인 버튼 추가
✅ 페이지 순서 재구성 (실제 작업 흐름)
✅ 페이지 간 데이터 영속성 강화 (자동 저장)
✅ 25명 동시 접속 지원 (개인 번호 기반 격리)

### 2. Block Generator
✅ 블록 상세 보기, 수정, 삭제 기능
✅ 개인 번호 기반 블록 ID 생성 및 완전 격리
✅ 카테고리별 템플릿 블록 제공
✅ 블록 검색 및 필터링 (개인/팀/공용 구분)

### 3. Mapping (Site Data Collection 통합)
✅ 데이터 수집 탭 추가
✅ 좌표 기준 반경 데이터 수집
✅ 시각화 및 다운로드
✅ 분석 블록 직접 연동 (2가지 대안)

### 4. Document Analysis
✅ 분석 중 블록 추가/제거/건너뛰기
✅ 피드백 기반 재검토 개선
✅ Mapping 데이터 불러오기
✅ 다중 포맷 다운로드 (Word/Excel/PDF/JSON)

### 5. Prompt Generator
✅ 미드저니, 나노바나나 지원
✅ 건축가 스타일 옵션
✅ 설계 회사 스타일 옵션
✅ 프롬프트 라이브러리

### 6. Video Storyboard Generator [신규]
✅ Scene 구성 및 편집
✅ Narrative 자동 생성
✅ 타임라인 뷰
✅ 스토리보드 다운로드

---

## 📐 사이트 기능 구조도 (다이어그램)

```
┌─────────────────────────────────────────────────────────────┐
│                    🔐 로그인 페이지 (신규)                    │
│               (개인 번호 입력 및 인증, API 키 자동 로드)       │
└────────────┬────────────────────────────────────────────────┘
             │ 로그인 성공
             ▼
┌─────────────────────────────────────────────────────────────┐
│                      🏠 메인 페이지                          │
│       (AI 모델 선택, 시스템 안내, 로그아웃 버튼)               │
└────────────┬────────────────────────────────────────────────┘
             │
    ┌────────┴────────┬─────────────┬─────────────┬──────────┐
    │                 │             │             │          │
    ▼                 ▼             ▼             ▼          ▼
┌────────┐      ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌────────┐
│ Block  │      │ Mapping  │  │ Document │  │ Prompt   │  │ Video  │
│Generator│────▶│          │─▶│ Analysis │─▶│Generator │─▶│Storyboard│
└────────┘      └──────────┘  └──────────┘  └──────────┘  └────────┘
    │                │              │             │             │
    │ ①블록 생성     │ ②데이터 수집  │ ③문서 분석   │ ④프롬프트   │ ⑤스토리보드
    │ (owner=개인번호)│             │             │             │
    │                │              │             │             │
    ▼                ▼              ▼             ▼             ▼
┌──────────────────────────────────────────────────────────────┐
│         Session State (개인 번호별 격리된 데이터 저장소)       │
│  user:{개인번호}:blocks    - mapping_data                     │
│  user:{개인번호}:analysis_results                            │
│  user:{개인번호}:generated_prompts - storyboard_scenes       │
└──────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ┌──────────────────┐
                    │  자동 저장 (5분)  │
                    │ Redis/PostgreSQL  │
                    │ (개인 번호 네임스페이스)│
                    └──────────────────┘
```

---

## 📝 블록 DSL 구조 설명

### 블록이란?

블록(Block)은 **특정 분석 작업을 정의하는 구조화된 프롬프트**입니다. RISEN 구조를 따르며, AI에게 명확한 지시를 전달합니다.

### 블록 저장 구조 (blocks.json)

```json
{
  "blocks": [
    {
      "id": "user001_location_001",
      "name": "후보지 평가",
      "description": "입지 후보지의 장단점을 평가하고 점수를 산정",
      "category": "입지 분석",
      "owner": "USER001",
      "visibility": "private",
      "created_at": "2025-01-20T10:00:00",
      "role": "당신은 도시 계획 및 입지 분석 전문가입니다...",
      "instructions": "제공된 후보지 데이터를 분석하여 다음을 수행하세요...",
      "steps": [
        "후보지 정보 스캔 및 핵심 데이터 식별",
        "접근성, 인프라, 환경 등 평가 항목별 분석",
        "SWOT 분석 수행",
        "정량적 점수 산정 (100점 만점)",
        "종합 평가 및 추천 의견 작성"
      ],
      "end_goal": "후보지별 정량적 점수와 정성적 평가를 제공하여 최적 입지 선정을 지원",
      "narrowing": {
        "output_format": "표 형식 + 텍스트 설명",
        "suggested_items": ["접근성 점수", "인프라 점수", "환경 점수", "총점", "추천 여부"],
        "constraints": "객관적 데이터 기반 평가, 주관적 의견 최소화",
        "quality_standards": "정량적 점수는 명확한 근거 제시"
      }
    }
  ]
}
```

### 분석 과정 (블록이 어떻게 사용되는지)

```
1. 블록 로드
   blocks.json → 블록 정보 읽기

2. DSPy Signature 자동 생성
   블록 정보 → Python 클래스 생성

   class 후보지평가Signature(dspy.Signature):
       """후보지 평가 Signature"""
       input = dspy.InputField(desc="후보지 데이터")
       output = dspy.OutputField(desc="평가 결과")

3. AI 모델에 프롬프트 전달
   role + instructions + steps → AI 입력

4. Chain-of-Thought 실행
   AI가 단계별로 사고 과정 기록:
   - Step 1: "후보지 A는 지하철역까지 500m..."
   - Step 2: "접근성 점수 90점 산정..."
   - ...

5. 결과 구조화
   AI 출력 → 정해진 형식(narrowing)으로 변환

6. 결과 저장
   st.session_state.analysis_results[block_id] = 결과
```

### 예시 블록 3개

#### 예시 1: 기본 정보 추출 블록

```json
{
  "id": "basic_info_extraction",
  "name": "기본 정보 추출",
  "category": "기본 정보 & 요구사항",
  "role": "건축 프로젝트 분석 전문가",
  "instructions": "제공된 문서에서 프로젝트의 기본 정보를 추출하세요",
  "steps": [
    "문서 전체 스캔",
    "프로젝트명, 위치, 건축주, 용도 식별",
    "주요 요구사항 추출",
    "구조화된 정보로 정리"
  ],
  "end_goal": "프로젝트의 핵심 정보를 체계적으로 추출",
  "narrowing": {
    "output_format": "표 형식",
    "suggested_items": ["프로젝트명", "위치", "건축주", "용도", "규모"]
  }
}
```

#### 예시 2: 입지 분석 블록 (위 예시와 동일)

#### 예시 3: 비즈니스 모델 블록 [신규]

```json
{
  "id": "business_model_canvas",
  "name": "비즈니스 모델 분석",
  "category": "비즈니스 모델",
  "role": "비즈니스 전략 및 수익 모델 분석가",
  "instructions": "프로젝트의 비즈니스 모델을 분석하고 비즈니스 모델 캔버스를 작성하세요",
  "steps": [
    "고객 세그먼트 식별",
    "가치 제안 정의",
    "채널 및 고객 관계 분석",
    "수익원 및 비용 구조 파악",
    "핵심 자원 및 파트너 식별",
    "비즈니스 모델 캔버스 작성"
  ],
  "end_goal": "프로젝트의 비즈니스 모델을 체계적으로 분석하여 수익성 및 지속가능성 평가",
  "narrowing": {
    "output_format": "비즈니스 모델 캔버스 9개 블록",
    "suggested_items": [
      "고객 세그먼트", "가치 제안", "채널", "고객 관계",
      "수익원", "핵심 자원", "핵심 활동", "핵심 파트너", "비용 구조"
    ],
    "constraints": "각 블록마다 구체적인 내용 작성, 상호 연관성 고려"
  }
}
```

---

## 📚 추가 고려사항

### 1. 수업 자료 초안 (2월 3째주까지)

**주차별 커리큘럼**:

- **1주차**: 시스템 소개 및 Block Generator
  - 목표: 분석 블록 이해 및 생성
  - 실습: 간단한 블록 1개 생성

- **2주차**: Mapping 및 데이터 수집
  - 목표: 지도 분석 및 도시 데이터 활용
  - 실습: 후보지 데이터 수집 및 시각화

- **3주차**: Document Analysis
  - 목표: AI 기반 문서 분석
  - 실습: 프로젝트 문서 분석 전체 워크플로우

- **4주차**: Prompt & Video Generator
  - 목표: 시각 자료 생성
  - 실습: 이미지 프롬프트 및 스토리보드 생성

### 2. Genspark 설명 추가 (다음 회의)

- Genspark AI 엔진 소개
- 프로젝트 분석 활용 방법
- 통합 가능성 검토

### 3. 템플릿 제공

- 프로젝트별 템플릿 (주거/상업/문화/교육)
- 블록 템플릿 (카테고리별)
- 스토리보드 템플릿

---

## 🔄 다음 단계

1. **개발 우선순위**:
   - **Phase 0 (최우선)**: 개인 번호 로그인 시스템 구현
     - 개인 번호 관리 DB/파일 설정
     - 로그인 페이지 구현
     - API 키 암호화 저장 및 자동 로드
     - 데이터 격리 구조 (Redis, PostgreSQL, 파일 시스템)
   - Phase 1: 공통 개선사항 (버튼 추가, 데이터 영속성)
   - Phase 2: Mapping 탭2 구현 (데이터 수집)
   - Phase 3: Document Analysis 분석 중 제어 기능
   - Phase 4: Prompt Generator 플랫폼 확장
   - Phase 5: Video Storyboard Generator 신규 페이지

2. **테스트**:
   - 개인 번호 로그인 및 권한 검증 테스트
   - API 키 암호화 저장 및 로드 테스트
   - 데이터 완전 격리 테스트 (다른 사용자 접근 불가 확인)
   - 블록 공개 범위별 접근 권한 테스트
   - 25명 동시 접속 테스트 (개인 번호별)
   - 데이터 영속성 테스트
   - 분석 블록 연동 테스트

3. **문서화**:
   - 관리자 가이드 (개인 번호 생성 및 관리)
   - 사용자 매뉴얼 (로그인 방법, 블록 공유 방법)
   - 개발자 가이드
   - API 문서

---

**문서 버전**: v2.1 (개인 번호 기반 시스템)
**최종 수정**: 2025-01-21

**주요 변경 (v2.1)**:
- 개인 번호 기반 로그인 시스템 추가
- API 키 영구 저장 (개인 번호에 연결)
- 완전한 데이터 격리 (개인 번호별)
- 블록 및 프로젝트 개인 소유 (선택적 공유 가능)
- 관리자 기능 추가 (개인 번호 관리)
